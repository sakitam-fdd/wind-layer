import{_ as s,c as i,o as a,ab as e}from"./chunks/framework.Dgh8ejg4.js";const y=JSON.parse('{"title":"数据说明","description":"","frontmatter":{"title":"数据说明"},"headers":[],"relativePath":"guide/data.md","filePath":"guide/data.md","lastUpdated":1713111717000}'),n={name:"guide/data.md"},t=e(`<h1 id="关于数据来源" tabindex="-1">关于数据来源 <a class="header-anchor" href="#关于数据来源">¶</a></h1><nav class="table-of-contents"><ul><li><a href="#_1-x-数据说明">1.x 数据说明</a><ul><li><a href="#数据详解">数据详解</a></li></ul></li><li><a href="#_2-x-数据说明">2.x 数据说明</a></li></ul></nav><h2 id="_1-x-数据说明" tabindex="-1">1.x 数据说明 <a class="header-anchor" href="#_1-x-数据说明">¶</a></h2><p>对应数据来源可以是gfs或者ecmwf，无论数据来源是哪个地方，最终此插件目前只支持<code>json</code>数据格式输入。</p><p>关于如何将数据文件转换为 <code>json</code> ，你可以查阅 <a href="https://github.com/cambecc/grib2json" target="_blank" rel="noreferrer">grib2json</a>, 或者 <a href="https://software.ecmwf.int/wiki/display/GRIB/Releases" target="_blank" rel="noreferrer">ecmwf</a> 的数据处理库，当然，你也可以自行处理格点数据；</p><p>另外在解析数据时需要注意数据是否翻转了，默认对于地图展示来说我们知道经度默认从左向右递增，纬度从上向下依次递减（不一定完全正确）， 所以在处理数据时我们需要注意数据的范围和方向，避免展示出错，相关有一个讨论可以在 <a href="https://github.com/sakitam-fdd/wind-layer/issues/44" target="_blank" rel="noreferrer">44</a> 看到。</p><h3 id="数据详解" tabindex="-1">数据详解 <a class="header-anchor" href="#数据详解">¶</a></h3><p>返回 <code>json</code> 数据为一个数组类型，两个元素分别为 U和V对应数据，数据中应该至少包含以下字段：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">dx:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Increment</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> X</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> direction,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> cannot</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> negative</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">x方向增量</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">dy:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Increment</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Y</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> direction,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> cannot</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> negative（Y方向增量）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">nx:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> cols</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 数据行数</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">ny:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> rows</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 数据列数</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># 以下四个为数据矩形范围</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lo1:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> xmin</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">lo2:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> xmax</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">la1:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ymin</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">la2:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ymax</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># u/v 主要由以下参数区分</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">parameterCategory:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> data</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> type</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">parameterNumber:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> data</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> type</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>一般情况下由 <code>grib2json</code> 转出的数据<code>parameterCategory</code>参数为<code>1</code>，当<code>parameterNumber</code> 为 <code>2</code> 时为<code>u</code> 分量， 当<code>parameterNumber</code> 为 <code>3</code> 时为<code>v</code> 分量。</p><p>并且还需要注意的是 <code>dy</code>（纬度）增量 (默认我们采用的数据和格点原始数据方向保持一致，数据从左上到右下) 但是需要注意的是此时 <code>dy</code> 为 -(ymax - ymin) / ny 有些情况下我们格点数据组织形式可能 Y 轴是上下翻转的，此时我们可以配置 <code>options.fieldOptions.flipY = true</code>，来主动翻转数据（默认情况下我们检测到数据配置中的 <code>deltaY &gt; 0</code> 时并且未配置<code>flipY</code>参数项默认去翻转数据）。</p><h2 id="_2-x-数据说明" tabindex="-1">2.x 数据说明 <a class="header-anchor" href="#_2-x-数据说明">¶</a></h2><p>在 2.0 版本之后（目前包括 <code>mapbox</code>、<code>maplibre</code>、<code>maptalks</code>）做了多数据源支持（<code>geotiff</code>、灰度图-可解析带 <a href="https://en.wikipedia.org/wiki/Exif" target="_blank" rel="noreferrer">exif</a> 信息、png-多通道浮点数压缩），其中 <code>geotiff</code> 的支持需要配置 <code>configDeps</code>, <code>exif</code> 默认支持，因为在 <code>safari</code> 浏览器下 <code>configDeps</code> 有兼容性问题，所以默认打包了 exif 的解析库。</p><div class="language-ts vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">mapboxWind</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">configDeps</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;https://unpkg.com/geotiff/dist-browser/geotiff.js&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>对于 2.x 版本的数据格式我们可以使用 <a href="https://github.com/sakitam-gis/raster-process" target="_blank" rel="noreferrer">https://github.com/sakitam-gis/raster-process</a> 来生成所需要的瓦片和单张图片。</p>`,15),p=[t];function l(h,r,d,k,c,o){return a(),i("div",null,p)}const F=s(n,[["render",l]]);export{y as __pageData,F as default};
