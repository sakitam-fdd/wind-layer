import{c as R,g as T}from"./commonjsHelpers.Cpj98o6Y.js";var I={exports:{}},O={exports:{}};(function(i,n){(function(t,r){i.exports=r()})(R,function(){function t(e,o,s,l,c){r(e,o,s||0,l||e.length-1,c||h)}function r(e,o,s,l,c){for(;l>s;){if(l-s>600){var u=l-s+1,m=o-s+1,S=Math.log(u),Y=.5*Math.exp(2*S/3),E=.5*Math.sqrt(S*Y*(u-Y)/u)*(m-u/2<0?-1:1),D=Math.max(s,Math.floor(o-m*Y/u+E)),N=Math.min(l,Math.floor(o+(u-m)*Y/u+E));r(e,o,D,N,c)}var v=e[o],B=s,f=l;for(a(e,s,o),c(e[l],v)>0&&a(e,s,l);B<f;){for(a(e,B,f),B++,f--;c(e[B],v)<0;)B++;for(;c(e[f],v)>0;)f--}c(e[s],v)===0?a(e,s,f):(f++,a(e,f,l)),f<=o&&(s=f+1),o<=f&&(l=f-1)}}function a(e,o,s){var l=e[o];e[o]=e[s],e[s]=l}function h(e,o){return e<o?-1:e>o?1:0}return t})})(O);var $=O.exports;I.exports=X;I.exports.default=X;var b=$;function X(i,n){if(!(this instanceof X))return new X(i,n);this._maxEntries=Math.max(4,i||9),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),n&&this._initFormat(n),this.clear()}X.prototype={all:function(){return this._all(this.data,[])},search:function(i){var n=this.data,t=[],r=this.toBBox;if(!g(i,n))return t;for(var a=[],h,e,o,s;n;){for(h=0,e=n.children.length;h<e;h++)o=n.children[h],s=n.leaf?r(o):o,g(i,s)&&(n.leaf?t.push(o):y(i,s)?this._all(o,t):a.push(o));n=a.pop()}return t},collides:function(i){var n=this.data,t=this.toBBox;if(!g(i,n))return!1;for(var r=[],a,h,e,o;n;){for(a=0,h=n.children.length;a<h;a++)if(e=n.children[a],o=n.leaf?t(e):e,g(i,o)){if(n.leaf||y(i,o))return!0;r.push(e)}n=r.pop()}return!1},load:function(i){if(!(i&&i.length))return this;if(i.length<this._minEntries){for(var n=0,t=i.length;n<t;n++)this.insert(i[n]);return this}var r=this._build(i.slice(),0,i.length-1,0);if(!this.data.children.length)this.data=r;else if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var a=this.data;this.data=r,r=a}this._insert(r,this.data.height-r.height-1,!0)}return this},insert:function(i){return i&&this._insert(i,this.data.height-1),this},clear:function(){return this.data=p([]),this},remove:function(i,n){if(!i)return this;for(var t=this.data,r=this.toBBox(i),a=[],h=[],e,o,s,l;t||a.length;){if(t||(t=a.pop(),o=a[a.length-1],e=h.pop(),l=!0),t.leaf&&(s=C(i,t.children,n),s!==-1))return t.children.splice(s,1),a.push(t),this._condense(a),this;!l&&!t.leaf&&y(t,r)?(a.push(t),h.push(e),e=0,o=t,t=t.children[0]):o?(e++,t=o.children[e],l=!1):t=null}return this},toBBox:function(i){return i},compareMinX:A,compareMinY:q,toJSON:function(){return this.data},fromJSON:function(i){return this.data=i,this},_all:function(i,n){for(var t=[];i;)i.leaf?n.push.apply(n,i.children):t.push.apply(t,i.children),i=t.pop();return n},_build:function(i,n,t,r){var a=t-n+1,h=this._maxEntries,e;if(a<=h)return e=p(i.slice(n,t+1)),x(e,this.toBBox),e;r||(r=Math.ceil(Math.log(a)/Math.log(h)),h=Math.ceil(a/Math.pow(h,r-1))),e=p([]),e.leaf=!1,e.height=r;var o=Math.ceil(a/h),s=o*Math.ceil(Math.sqrt(h)),l,c,u,m;for(F(i,n,t,s,this.compareMinX),l=n;l<=t;l+=s)for(u=Math.min(l+s-1,t),F(i,l,u,o,this.compareMinY),c=l;c<=u;c+=o)m=Math.min(c+o-1,u),e.children.push(this._build(i,c,m,r-1));return x(e,this.toBBox),e},_chooseSubtree:function(i,n,t,r){for(var a,h,e,o,s,l,c,u;r.push(n),!(n.leaf||r.length-1===t);){for(c=u=1/0,a=0,h=n.children.length;a<h;a++)e=n.children[a],s=w(e),l=J(i,e)-s,l<u?(u=l,c=s<c?s:c,o=e):l===u&&s<c&&(c=s,o=e);n=o||n.children[0]}return n},_insert:function(i,n,t){var r=this.toBBox,a=t?i:r(i),h=[],e=this._chooseSubtree(a,this.data,n,h);for(e.children.push(i),d(e,a);n>=0&&h[n].children.length>this._maxEntries;)this._split(h,n),n--;this._adjustParentBBoxes(a,h,n)},_split:function(i,n){var t=i[n],r=t.children.length,a=this._minEntries;this._chooseSplitAxis(t,a,r);var h=this._chooseSplitIndex(t,a,r),e=p(t.children.splice(h,t.children.length-h));e.height=t.height,e.leaf=t.leaf,x(t,this.toBBox),x(e,this.toBBox),n?i[n-1].children.push(e):this._splitRoot(t,e)},_splitRoot:function(i,n){this.data=p([i,n]),this.data.height=i.height+1,this.data.leaf=!1,x(this.data,this.toBBox)},_chooseSplitIndex:function(i,n,t){var r,a,h,e,o,s,l,c;for(s=l=1/0,r=n;r<=t-n;r++)a=M(i,0,r,this.toBBox),h=M(i,r,t,this.toBBox),e=P(a,h),o=w(a)+w(h),e<s?(s=e,c=r,l=o<l?o:l):e===s&&o<l&&(l=o,c=r);return c},_chooseSplitAxis:function(i,n,t){var r=i.leaf?this.compareMinX:A,a=i.leaf?this.compareMinY:q,h=this._allDistMargin(i,n,t,r),e=this._allDistMargin(i,n,t,a);h<e&&i.children.sort(r)},_allDistMargin:function(i,n,t,r){i.children.sort(r);var a=this.toBBox,h=M(i,0,n,a),e=M(i,t-n,t,a),o=_(h)+_(e),s,l;for(s=n;s<t-n;s++)l=i.children[s],d(h,i.leaf?a(l):l),o+=_(h);for(s=t-n-1;s>=n;s--)l=i.children[s],d(e,i.leaf?a(l):l),o+=_(e);return o},_adjustParentBBoxes:function(i,n,t){for(var r=t;r>=0;r--)d(n[r],i)},_condense:function(i){for(var n=i.length-1,t;n>=0;n--)i[n].children.length===0?n>0?(t=i[n-1].children,t.splice(t.indexOf(i[n]),1)):this.clear():x(i[n],this.toBBox)},_initFormat:function(i){var n=["return a"," - b",";"];this.compareMinX=new Function("a","b",n.join(i[0])),this.compareMinY=new Function("a","b",n.join(i[1])),this.toBBox=new Function("a","return {minX: a"+i[0]+", minY: a"+i[1]+", maxX: a"+i[2]+", maxY: a"+i[3]+"};")}};function C(i,n,t){if(!t)return n.indexOf(i);for(var r=0;r<n.length;r++)if(t(i,n[r]))return r;return-1}function x(i,n){M(i,0,i.children.length,n,i)}function M(i,n,t,r,a){a||(a=p(null)),a.minX=1/0,a.minY=1/0,a.maxX=-1/0,a.maxY=-1/0;for(var h=n,e;h<t;h++)e=i.children[h],d(a,i.leaf?r(e):e);return a}function d(i,n){return i.minX=Math.min(i.minX,n.minX),i.minY=Math.min(i.minY,n.minY),i.maxX=Math.max(i.maxX,n.maxX),i.maxY=Math.max(i.maxY,n.maxY),i}function A(i,n){return i.minX-n.minX}function q(i,n){return i.minY-n.minY}function w(i){return(i.maxX-i.minX)*(i.maxY-i.minY)}function _(i){return i.maxX-i.minX+(i.maxY-i.minY)}function J(i,n){return(Math.max(n.maxX,i.maxX)-Math.min(n.minX,i.minX))*(Math.max(n.maxY,i.maxY)-Math.min(n.minY,i.minY))}function P(i,n){var t=Math.max(i.minX,n.minX),r=Math.max(i.minY,n.minY),a=Math.min(i.maxX,n.maxX),h=Math.min(i.maxY,n.maxY);return Math.max(0,a-t)*Math.max(0,h-r)}function y(i,n){return i.minX<=n.minX&&i.minY<=n.minY&&n.maxX<=i.maxX&&n.maxY<=i.maxY}function g(i,n){return n.minX<=i.maxX&&n.minY<=i.maxY&&n.maxX>=i.minX&&n.maxY>=i.minY}function p(i){return{children:i,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function F(i,n,t,r,a){for(var h=[n,t],e;h.length;)t=h.pop(),n=h.pop(),!(t-n<=r)&&(e=n+Math.ceil((t-n)/r/2)*r,b(i,e,n,t,a),h.push(n,e,e,t))}var k=I.exports;const U=T(k);export{U as r};
